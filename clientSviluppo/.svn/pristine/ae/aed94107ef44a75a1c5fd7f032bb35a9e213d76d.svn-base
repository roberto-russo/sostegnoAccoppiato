package it.csi.services;

import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

import java.util.Optional;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import it.csi.demetra.demetraws.zoo.ZooApplication;
import it.csi.demetra.demetraws.zoo.model.Dmt_s_sessione;
import it.csi.demetra.demetraws.zoo.model.Dmt_t_Ref9902;
import it.csi.demetra.demetraws.zoo.services.Dmt_t_Ref9902_services;
import it.csi.demetra.demetraws.zoo.services.Dmt_t_sessione_services;

@RunWith(SpringRunner.class)
@SpringBootTest(classes = ZooApplication.class)
public class Dmt_t_Ref9902_services_TestCase {
	
	@Autowired
	Dmt_t_Ref9902_services ref9902Service;
	
	@Autowired
	Dmt_t_sessione_services sessioneService;

	@Test
	public void saveTest() {
		Dmt_t_Ref9902 modelRef9902 = new  Dmt_t_Ref9902();
		
		Long idSessione = 1L;
		String cuaa = "SPSRVH91A23G383R";
		
		Dmt_s_sessione sessione = null;
		
		try {
			sessione = 	sessioneService.getById(idSessione);

		} catch(Exception ex) {
			fail("caught exception while retrieving sessione");
		}
		
		assertNotNull("sessione is null", sessione);
		
		modelRef9902.setCuaa(cuaa);
		modelRef9902.setEsito("OK");
		modelRef9902.setMotivazioni("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam vel fringilla urna. Phasellus eget tortor elit. Morbi dictum quam mollis, pharetra augue sit amet, lacinia lectus. Sed placerat massa arcu, eu maximus orci mollis sit amet. Quisque eget massa sit amet purus lobortis euismod. Praesent eleifend purus purus, vitae posuere metus aliquam a. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin mauris erat, faucibus quis ante eget, aliquet faucibus mi. Donec lectus lectus, mollis quis dui sit amet, maximus feugiat sem. Praesent id justo vitae purus rhoncus dignissim. Donec eu vulputate orci, eget scelerisque libero");
		modelRef9902.setSessione(sessione);
		try {
			ref9902Service.save(modelRef9902);

		} catch(Exception ex) {
			fail("caught exception while saving ref9902 model");
		}
		
		
		try {
			Dmt_t_Ref9902 model = Optional.of(ref9902Service.getByIdSessioneAndCuaa(idSessione, cuaa)).orElse(null).get(0);
			
			assertNotNull("model is null", model);
			
			assertTrue("cuaa mismatching", model.getCuaa().equals(modelRef9902.getCuaa()));
			
		} catch (Exception ex) {
			fail("caught exception while retrieving ref9902 model");
		}
		
		
	
	}

}
